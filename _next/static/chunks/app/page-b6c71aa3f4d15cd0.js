(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4016:function(e,s,t){Promise.resolve().then(t.bind(t,7264))},7264:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return d}});var l=t(7437),a=t(2265);function i(){let[e,s]=(0,a.useState)(155),[t,i]=(0,a.useState)("15:30");return(0,a.useEffect)(()=>{let e=async()=>{try{let e=await fetch("/api/exchange-rates"),t=await e.json();t.rate&&s(t.rate)}catch(e){console.error("為替レート取得エラー:",e)}};e();let t=setInterval(e,36e5);return()=>clearInterval(t)},[]),(0,a.useEffect)(()=>{let e=()=>{i(new Date().toLocaleTimeString("ja-JP",{hour:"2-digit",minute:"2-digit"}))};e();let s=setInterval(e,6e4);return()=>clearInterval(s)},[]),(0,l.jsx)("header",{className:"header",children:(0,l.jsxs)("div",{className:"header-content",children:[(0,l.jsx)("div",{className:"logo",children:"\uD83D\uDCCA StockX Arbitrage Monitor"}),(0,l.jsxs)("div",{className:"header-info",children:[(0,l.jsxs)("div",{className:"exchange-rate",children:["\uD83D\uDCB1 1 USD = \xa5",e.toFixed(2)]}),(0,l.jsxs)("div",{className:"update-status",children:[(0,l.jsx)("span",{className:"status-dot"}),(0,l.jsxs)("span",{children:["最終更新: ",t]})]})]})]})})}function c(){let[e,s]=(0,a.useState)({totalProducts:248,profitableProducts:37,avgProfitRate:18.5,maxProfit:8750,maxProfitProduct:"Dunk Low Chicago",changes:{totalProducts:12,profitableProducts:5,avgProfitRate:-2.3}});return(0,a.useEffect)(()=>{let e=async()=>{try{let e=await fetch("/api/stats"),t=await e.json();s(t)}catch(e){console.error("統計データ取得エラー:",e)}};e();let t=setInterval(e,18e5);return()=>clearInterval(t)},[]),(0,l.jsxs)("div",{className:"stats-container",children:[(0,l.jsxs)("div",{className:"stat-card",children:[(0,l.jsx)("div",{className:"stat-title",children:"監視中の商品"}),(0,l.jsx)("div",{className:"stat-value",children:e.totalProducts.toLocaleString()}),(0,l.jsxs)("div",{className:"stat-change ".concat(e.changes.totalProducts>=0?"positive":"negative"),children:[e.changes.totalProducts>=0?"+":"",e.changes.totalProducts," 本日追加"]})]}),(0,l.jsxs)("div",{className:"stat-card",children:[(0,l.jsx)("div",{className:"stat-title",children:"利益可能商品"}),(0,l.jsx)("div",{className:"stat-value",children:e.profitableProducts}),(0,l.jsxs)("div",{className:"stat-change ".concat(e.changes.profitableProducts>=0?"positive":"negative"),children:[e.changes.profitableProducts>=0?"+":"",e.changes.profitableProducts," 前日比"]})]}),(0,l.jsxs)("div",{className:"stat-card",children:[(0,l.jsx)("div",{className:"stat-title",children:"平均利益率"}),(0,l.jsxs)("div",{className:"stat-value",children:[e.avgProfitRate,"%"]}),(0,l.jsxs)("div",{className:"stat-change ".concat(e.changes.avgProfitRate>=0?"positive":"negative"),children:[e.changes.avgProfitRate>=0?"+":"",e.changes.avgProfitRate,"%"]})]}),(0,l.jsxs)("div",{className:"stat-card",children:[(0,l.jsx)("div",{className:"stat-title",children:"最高利益商品"}),(0,l.jsxs)("div",{className:"stat-value",children:["\xa5",e.maxProfit.toLocaleString()]}),(0,l.jsx)("div",{className:"stat-change",children:e.maxProfitProduct})]})]})}function r(e){let{onFilterChange:s,onRefresh:t}=e,[i,c]=(0,a.useState)({brand:"all",category:"all",minProfit:1e3,size:"all",popularOnly:!0,inStockOnly:!1}),r=(e,t)=>{let l={...i,[e]:t};c(l),s(l)};return(0,l.jsx)("div",{className:"controls",children:(0,l.jsxs)("div",{className:"filter-row",children:[(0,l.jsxs)("div",{className:"filter-group",children:[(0,l.jsx)("label",{className:"filter-label",children:"ブランド"}),(0,l.jsxs)("select",{className:"filter-select",value:i.brand,onChange:e=>r("brand",e.target.value),children:[(0,l.jsx)("option",{value:"all",children:"すべて"}),(0,l.jsx)("option",{value:"nike",children:"Nike"}),(0,l.jsx)("option",{value:"adidas",children:"Adidas"})]})]}),(0,l.jsxs)("div",{className:"filter-group",children:[(0,l.jsx)("label",{className:"filter-label",children:"カテゴリ"}),(0,l.jsxs)("select",{className:"filter-select",value:i.category,onChange:e=>r("category",e.target.value),children:[(0,l.jsx)("option",{value:"all",children:"すべて"}),(0,l.jsx)("option",{value:"sneakers",children:"スニーカー"}),(0,l.jsx)("option",{value:"sandals",children:"サンダル"})]})]}),(0,l.jsxs)("div",{className:"filter-group",children:[(0,l.jsx)("label",{className:"filter-label",children:"最低利益"}),(0,l.jsx)("input",{type:"number",className:"filter-input",placeholder:"\xa51,000",value:i.minProfit,onChange:e=>r("minProfit",parseInt(e.target.value)||0)})]}),(0,l.jsxs)("div",{className:"filter-group",children:[(0,l.jsx)("label",{className:"filter-label",children:"サイズ"}),(0,l.jsxs)("select",{className:"filter-select",value:i.size,onChange:e=>r("size",e.target.value),children:[(0,l.jsx)("option",{value:"all",children:"すべて"}),(0,l.jsx)("option",{value:"small",children:"US 4-7"}),(0,l.jsx)("option",{value:"regular",children:"US 8-11"}),(0,l.jsx)("option",{value:"large",children:"US 12+"})]})]}),(0,l.jsxs)("div",{className:"filter-group",children:[(0,l.jsx)("label",{className:"filter-label",children:"表示オプション"}),(0,l.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[(0,l.jsx)("div",{className:"filter-checkbox ".concat(i.popularOnly?"active":""),onClick:()=>r("popularOnly",!i.popularOnly),children:"人気商品のみ"}),(0,l.jsx)("div",{className:"filter-checkbox ".concat(i.inStockOnly?"active":""),onClick:()=>r("inStockOnly",!i.inStockOnly),children:"在庫ありのみ"})]})]}),(0,l.jsx)("button",{className:"btn-refresh",onClick:()=>{t()},children:"\uD83D\uDD04 更新"})]})})}function n(e){var s,t,i,c,r,n,o;let{product:d}=e,[h,x]=(0,a.useState)(!1),u=d.price_history&&d.price_history.length>0?d.price_history[0]:null,j=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"JPY";return e?"USD"===s?"$".concat(e):"\xa5".concat(e.toLocaleString()):"-"};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:(0,l.jsxs)("div",{className:"product-cell",children:[(0,l.jsx)("div",{className:"product-image",children:d.image_url?(0,l.jsx)("img",{src:d.image_url,alt:d.name}):(0,l.jsx)("div",{className:"w-full h-full bg-gray-100 flex items-center justify-center text-gray-400 text-xs",children:"IMG"})}),(0,l.jsxs)("div",{className:"product-info",children:[(0,l.jsx)("div",{className:"product-name",children:d.name}),(0,l.jsx)("div",{className:"product-sku",children:d.sku}),(0,l.jsx)("div",{className:"product-brand",children:d.brand})]})]})}),(0,l.jsx)("td",{className:"price-cell",children:u?(0,l.jsxs)(l.Fragment,{children:[j(147.68*u.stockx_lowest_ask,"JPY"),(0,l.jsx)("div",{className:"price-usd",children:j(u.stockx_lowest_ask,"USD")})]}):"-"}),(0,l.jsx)("td",{className:"price-cell",children:u?(0,l.jsxs)(l.Fragment,{children:[j(u.japan_lowest_price),(0,l.jsx)("div",{className:"price-source",children:u.japan_lowest_source||"N/A"})]}):"-"}),(0,l.jsx)("td",{className:"price-cell",children:u&&u.stockx_lowest_ask&&u.japan_lowest_price?(0,l.jsxs)("span",{className:"profit-positive",children:["+\xa5",(147.68*u.stockx_lowest_ask-u.japan_lowest_price).toLocaleString()]}):"-"}),(0,l.jsx)("td",{children:u?(0,l.jsxs)("div",{className:"expense-details",children:["手数料: \xa5",(null===(s=u.stockx_fee)||void 0===s?void 0:s.toLocaleString())||"N/A",(0,l.jsx)("br",{}),"関税: \xa5",(null===(t=u.customs_duty)||void 0===t?void 0:t.toLocaleString())||"N/A",(0,l.jsx)("br",{}),"国内送料: \xa5",(null===(i=u.domestic_shipping)||void 0===i?void 0:i.toLocaleString())||"N/A",(0,l.jsx)("br",{}),(0,l.jsxs)("strong",{children:["合計: \xa5",null===(c=(u.stockx_fee||0)+(u.customs_duty||0)+(u.domestic_shipping||0))||void 0===c?void 0:c.toLocaleString()]})]}):"-"}),(0,l.jsx)("td",{className:"profit-cell",children:u?(0,l.jsxs)(l.Fragment,{children:[(e=>{if(!e)return"-";let s=e>0;return(0,l.jsxs)("span",{className:s?"profit-positive":"profit-negative",children:[s?"+":"","\xa5",e.toLocaleString()]})})(u.net_profit),(0,l.jsxs)("div",{className:"profit-rate",children:["利益率: ",(null===(r=u.profit_rate)||void 0===r?void 0:r.toFixed(1))||"N/A","%"]})]}):"-"}),(0,l.jsx)("td",{children:(o=d.popularity_rank||999)<=3?(0,l.jsxs)("span",{className:"popularity-badge hot",children:["#",o," \uD83D\uDD25"]}):(0,l.jsxs)("span",{className:"popularity-badge",children:["#",o]})}),(0,l.jsx)("td",{className:"action-cell",children:u&&u.net_profit>0?(0,l.jsx)("button",{className:"btn-buy",onClick:()=>{var e;confirm("".concat(d.name,"を購入しますか？\n予想利益: \xa5").concat((null==u?void 0:null===(e=u.net_profit)||void 0===e?void 0:e.toLocaleString())||"N/A"))&&alert("購入ページへ遷移します（実装予定）")},children:"購入"}):(0,l.jsx)("button",{className:"btn-detail",onClick:()=>{x(!h)},children:"詳細"})})]}),h&&(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:"8",className:"bg-gray-50 p-4",children:(0,l.jsxs)("div",{className:"text-sm",children:[(0,l.jsx)("h4",{className:"font-semibold mb-2",children:"詳細情報"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"最終更新:"})," ",u?new Date(u.recorded_at).toLocaleString("ja-JP"):"N/A"]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"為替レート:"})," ",(null==u?void 0:u.exchange_rate)||"N/A"]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"StockX URL:"})," ",(0,l.jsxs)("a",{href:"https://stockx.com/".concat(d.sku),target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:["https://stockx.com/",d.sku]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{children:(0,l.jsx)("strong",{children:"価格詳細:"})}),(0,l.jsxs)("ul",{className:"text-xs text-gray-600 ml-2",children:[(0,l.jsxs)("li",{children:["StockX最低売値: $",(null==u?void 0:u.stockx_lowest_ask)||"N/A"]}),(0,l.jsxs)("li",{children:["StockX最高買値: $",(null==u?void 0:u.stockx_highest_bid)||"N/A"]}),(0,l.jsxs)("li",{children:["StockX最終売値: $",(null==u?void 0:u.stockx_last_sale)||"N/A"]}),(0,l.jsxs)("li",{children:["日本最安値: \xa5",(null==u?void 0:null===(n=u.japan_lowest_price)||void 0===n?void 0:n.toLocaleString())||"N/A"]})]})]})]})]})})})]})}function o(e){let{filters:s}=e,[t,i]=(0,a.useState)([]),[c,r]=(0,a.useState)(!0),[o,d]=(0,a.useState)("popularity"),[h,x]=(0,a.useState)(null);(0,a.useEffect)(()=>{u();let e=setInterval(()=>{console.log("自動更新中..."),u()},3e4);return()=>clearInterval(e)},[s,o]);let u=async()=>{r(!0);try{let e=new URLSearchParams({...s,sortBy:o,limit:100}),t=await fetch("/api/products?".concat(e)),l=await t.json();i(l),x(new Date)}catch(e){console.error("商品データ取得エラー:",e)}finally{r(!1)}},j=e=>[["商品名","SKU","サイズ","ブランド","カテゴリ","StockX価格(USD)","StockX価格(JPY)","日本最安値","日本サイト","差額","手数料","関税","国内送料","予想利益","利益率","人気度"],...e.map(e=>[e.name,e.sku,e.size_us,e.brand,e.category,e.stockx_price_usd,e.stockx_price_jpy,e.japan_lowest_price,e.japan_lowest_source,e.price_difference,e.stockx_fee,e.customs_duty,e.domestic_shipping,e.net_profit,e.profit_rate,e.popularity_rank])].map(e=>e.join(",")).join("\n");return c?(0,l.jsxs)("div",{className:"table-container",children:[(0,l.jsx)("div",{className:"table-header",children:(0,l.jsx)("h2",{className:"table-title",children:"価格比較リスト"})}),(0,l.jsxs)("div",{className:"loading",children:[(0,l.jsx)("div",{className:"spinner"}),(0,l.jsx)("p",{children:"データを読み込み中..."})]})]}):(0,l.jsxs)("div",{className:"table-container",children:[(0,l.jsxs)("div",{className:"table-header",children:[(0,l.jsx)("h2",{className:"table-title",children:"価格比較リスト"}),(0,l.jsxs)("div",{className:"table-controls",children:[h&&(0,l.jsxs)("div",{className:"last-update",children:["最終更新: ",h.toLocaleString("ja-JP")]}),(0,l.jsx)("button",{className:"export-btn",onClick:()=>{let e=new Blob([j(t)],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),l=URL.createObjectURL(e);s.setAttribute("href",l),s.setAttribute("download","stockx_arbitrage_".concat(new Date().toISOString().split("T")[0],".csv")),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s)},children:"CSVエクスポート"})]})]}),(0,l.jsx)("div",{className:"data-table",children:(0,l.jsxs)("table",{children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{style:{width:"25%"},children:"商品情報"}),(0,l.jsx)("th",{style:{width:"10%"},children:"StockX価格"}),(0,l.jsx)("th",{style:{width:"10%"},children:"日本最安値"}),(0,l.jsx)("th",{style:{width:"10%"},children:"差額"}),(0,l.jsx)("th",{style:{width:"20%"},children:"経費内訳"}),(0,l.jsx)("th",{style:{width:"10%"},children:"予想利益"}),(0,l.jsx)("th",{style:{width:"8%"},children:"人気度"}),(0,l.jsx)("th",{style:{width:"7%"},children:"操作"})]})}),(0,l.jsx)("tbody",{children:0===t.length?(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:"8",className:"text-center py-8 text-gray-500",children:"条件に一致する商品が見つかりませんでした"})}):t.map(e=>(0,l.jsx)(n,{product:e},"".concat(e.id,"-").concat(e.size_id)))})]})})]})}function d(){let[e,s]=(0,a.useState)({brand:"all",category:"all",minProfit:1e3,size:"all",popularOnly:!0,inStockOnly:!1});return(0,l.jsxs)("main",{children:[(0,l.jsx)(i,{}),(0,l.jsx)(c,{}),(0,l.jsx)(r,{onFilterChange:e=>{s(e)},onRefresh:()=>{window.location.reload()}}),(0,l.jsx)(o,{filters:e})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=4016)}),_N_E=e.O()}]);